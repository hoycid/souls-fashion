<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Spectral"
    />
    <link rel="stylesheet" href="resources/styles.css" />
    <link rel="icon" type="image/x-icon" href="icon.ico" />
    <link
      rel="apple-touch-icon"
      type="image/png"
      sizes="180x180"
      href="favicons/icon_180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="favicons/icon_16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="favicons/icon_32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="favicons/icon_48x48.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="favicons/icon_96x96.png"
    />
    <title>Elden Ring - Fashion Souls v1.0.3</title>
  </head>
  <body>
    <nav class="navigation">
      <div class="topnav">
        <div class="search-bar">
          <div class="color-picker-group">
            <input
              class="color-picker"
              type="color"
              id="favcolor"
              name="favcolor"
              value="ff0000"
            />
          </div>
          <input
            class="search-input"
            type="text"
            id="searchInput"
            placeholder="Search by item"
          />
          <div class="search-bar-buttons">
            <button class="toggle-search-button" id="toggleSearch">Item</button>
          </div>
        </div>
        <div class="links-group">
          <a href="index">Home</a>
          <a href="https://discord.gg/j8HHh8ffEn">Discord</a>
          <a href="https://github.com/jadepilled/souls-fashion">Github</a>
          <a href="https://ko-fi.com/psyopgirl">Donate</a>
          <a href="feedback.html">Feedback</a>
          <button class="mode-switch" id="modeToggle">Light Mode</button>
        </div>
      </div>
      <div class="filters-group">
        <button id="headFilter">Head</button>
        <button id="chestFilter">Chest</button>
        <button id="handsFilter">Hands</button>
        <button id="legsFilter">Legs</button>
        <button id="weaponsFilter">Weapons</button>
        <button id="shieldsFilter">Shields</button>
        <button id="clearFilter">Clear Filters</button>
        <div class="sliders">
          <div class="slider-container">
            <label for="secondaryWeightSlider">
              <div class="tooltip">
                Weight for Secondary Colors:
                <span class="tooltip-text">
                  Determines to what extent secondary colors are included in
                  your color match results. Higher weight = more consideration
                  given to secondary colors.</span>
              </div>
            </label>
            <input
              type="range"
              id="secondaryWeightSlider"
              name="secondaryWeight"
              min="0"
              max="1"
              step="0.1"
              value="0.5"
            />
            <p id="sliderValue">0.5</p>
          </div>
          <div class="slider-container">
            <label for="colorThresholdSlider">
              <div class="tooltip">
                Color Similarity Threshold:
                <span class="tooltip-text">
                  Allows you to specify how similar search results should be to
                  your chosen color. Setting the threshold higher will include
                  items that are less similar in color to your chosen color, and
                  vice versa.
                </span>
              </div>
            </label>
            <input
              type="range"
              id="colorThresholdSlider"
              name="colorThreshold"
              min="0"
              max="500"
              step="10"
              value="100"
            />
            <p id="colorThresholdValue">100</p>
          </div>
        </div>
      </div>
    </nav>

    <main class="item-grid" id="itemGrid">
      <p>Loading...</p>
      <!-- Items will be dynamically loaded here -->
    </main>

    <footer class="footer">
      <div class="copywrite">
        Copyright Â© Psyopgirl 2024.<br />
        Dark Souls, Elden Ring, Bloodborne & Demon's Souls are property of Sony
        & FromSoftware respectively.
      </div>
      <button class="back-to-top-button">Back to Top</button>
    </footer>

    <script src="search_items_eldenring.js"></script>
    <script>
      const modeToggle = document.getElementById("modeToggle");
      const body = document.body;
      const toggleSearch = document.getElementById("toggleSearch");
      const colorPicker = document.getElementById("favcolor");
      const searchInput = document.getElementById("searchInput");

      let isDarkMode = localStorage.getItem("theme") === "dark"; // Retrieve mode from localStorage

      toggleSearch.addEventListener("click", () => {
        const isColorPickerVisible = colorPicker.style.display !== "none";
        colorPicker.style.display = isColorPickerVisible
          ? "none"
          : "inline-block";
        toggleSearch.textContent = isColorPickerVisible ? "Item" : "Hex";
        searchInput.placeholder = isColorPickerVisible
          ? "Search by item"
          : "Search by hex";
        searchInput.disabled = isColorPickerVisible;
        searchInput.value = "";
        colorPicker.value = "";
      });

      // Initially hide the color picker if needed
      colorPicker.style.display = "none";

      // Update searchInput value whenever favcolor changes
      colorPicker.addEventListener("input", () => {
        searchInput.placeholder = colorPicker.value;
      });

      // Apply the initial theme from localStorage
      body.classList.toggle("light-mode", !isDarkMode);
      modeToggle.textContent = isDarkMode ? "Light Mode" : "Dark Mode";

      modeToggle.addEventListener("click", () => {
        isDarkMode = !isDarkMode;
        body.classList.toggle("light-mode", !isDarkMode);
        localStorage.setItem("theme", isDarkMode ? "dark" : "light");
        modeToggle.textContent = isDarkMode ? "Light Mode" : "Dark Mode";
      });

      document
        .querySelector(".back-to-top-button")
        .addEventListener("click", () => {
          window.scrollTo({ top: 0, behavior: "smooth" });
        });

      // Add click event listener to all anchor links for fade effect
      document.querySelectorAll("a").forEach(link => {
        link.addEventListener("click", function (e) {
          e.preventDefault(); // Prevent default link behavior
          document.body.classList.add("fade-out"); // Add fade-out class

          // Delay the navigation to the new page to allow the fade-out effect to play
          setTimeout(() => {
            window.location.href = this.href; // Navigate to the new page
          }, 500); // Match this duration with the CSS transition duration
        });
      });

      // Listen for visibility change to manage the fade-in effect
      document.addEventListener("visibilitychange", () => {
        document.body.classList.toggle(
          "fade-out",
          document.visibilityState !== "visible"
        );
      });
    </script>
  </body>
</html>
